version: "3.9"
services:
  # zk singleton
  zookeeper:
    image: ${ZOOKEEPER_IMAGE}
    environment:
      - MODE=singleton
  # kafka cluster
  kafka1:
    image: ${KAFKA_IMAGE}
    environment:
      - zookeeper_server=zookeeper:2181
      - MODE=cluster
      - ID=0
    depends_on:
      - zookeeper
  kafka2:
    image: ${KAFKA_IMAGE}
    environment:
      - zookeeper_server=zookeeper:2181
      - MODE=cluster
      - ID=1
    depends_on:
      - zookeeper
  kafka3:
    image: ${KAFKA_IMAGE}
    environment:
      - zookeeper_server=zookeeper:2181
      - MODE=cluster
      - ID=2
    depends_on:
      - zookeeper
networks:
  my-kafka-cluster: